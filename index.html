<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <!-- è§£å†³è±†ç“£å›¾ç‰‡åŠ äº†é˜²ç›—é“¾ï¼Œæ— æ³•æ˜¾ç¤ºçš„é—®é¢˜ -->
  <meta name="referrer" content="no-referrer">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è±†ç“£å½±è§†</title>
  <link href="https://cdn.bootcdn.net/ajax/libs/normalize/8.0.1/normalize.min.css" rel="stylesheet">
  <style>
    a {
      text-decoration: none;
      overflow: hidden;
      position: relative;
      color: #000;
    }

    .container {
      width: 100%;
      height: 100%;
    }

    .filter {
      margin-left: 20px;
    }

    .stars,
    .genres,
    .years {
      margin-top: 10px;
    }

    .content {
      display: flex;
      /* æ¢è¡Œæ˜¾ç¤º */
      flex-wrap: wrap;
      justify-content: space-around;
      text-align: center;
    }

    .list {
      display: flex;
      /* å®šä¹‰ä¸»è½´æ”¾ä¸‹ï¼šä¸Šä¸‹ */
      flex-direction: column;
      margin-left: 10px;
      margin-top: 10px;
      position: relative;
    }

    .d-canvas {
      width: 60px;
      height: 60px;
      background-color: #081c22;
      border-radius: 50%;
      position: absolute;
      right: 4px;
      top: 316px;
      z-index: 1;
    }

    img {
      width: 270px;
      height: 380px;
      transition: 1s ease-in-out;
    }

    .list:hover img {
      transform: scale(1.1);
    }

    .active {
      color: #fff;
      background-color: #081c22;
      border-radius: 5px;
    }

    #myBtn {
      display: none;
      position: fixed;
      bottom: 20px;
      right: 30px;
      z-index: 99;
      font-size: 18px;
      border: none;
      outline: none;
      background-color: red;
      color: white;
      cursor: pointer;
      padding: 15px;
      border-radius: 4px;
    }

    #myBtn:hover {
      background-color: #555;
    }

    .img-hide.visible {
      opacity: 1;
      transform: translateY(0);
    }

    .img-hide {
      opacity: 0;
      transform: translateY(6%);
      transition: opacity .4s ease, transform .8s ease;
    }

    .info div {
      padding-top: 8px;
    }

    @media (min-width: 1200px) {
      .list:hover .info {
        display: block;
      }

      .info {
        background: rgba(0, 0, 0, .6);
        backdrop-filter: blur(6px);
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        padding: 60px 30px 20px;
        color: #fff;
        display: none;
        position: absolute;
      }

    }
  </style>
</head>

<body>
  <button onclick="topFunction()" id="myBtn" title="Go to top">Top</button>
  <div class="container" id="container">
    <div class="filter">
      <div class="genres">
        <a href="javascript:void 0;" class="search" data-search="genres" data-value="">å…¨éƒ¨</a>
        <a href="javascript:void 0;" class="search" data-search="genres" data-value="åŠ¨ä½œ">åŠ¨ä½œ</a>
        <a href="javascript:void 0;" class="search" data-search="genres" data-value="åŠ¨ç”»">åŠ¨ç”»</a>
        <a href="javascript:void 0;" class="search" data-search="genres" data-value="å–œå‰§">å–œå‰§</a>
        <a href="javascript:void 0;" class="search" data-search="genres" data-value="å†å²">å†å²</a>
        <a href="javascript:void 0;" class="search" data-search="genres" data-value="ç§‘å¹»">ç§‘å¹»</a>
        <a href="javascript:void 0;" class="search" data-search="genres" data-value="çºªå½•ç‰‡">çºªå½•ç‰‡</a>
        <a href="javascript:void 0;" class="search" data-search="genres" data-value="å‰§æƒ…">å‰§æƒ…</a>
        <a href="javascript:void 0;" class="search" data-search="genres" data-value="å¥‡å¹»">å¥‡å¹»</a>
        <a href="javascript:void 0;" class="search" data-search="genres" data-value="çŠ¯ç½ª">çŠ¯ç½ª</a>
        <a href="javascript:void 0;" class="search" data-search="genres" data-value="è¿åŠ¨">è¿åŠ¨</a>
        <a href="javascript:void 0;" class="search" data-search="genres" data-value="å®¶åº­">å®¶åº­</a>
        <a href="javascript:void 0;" class="search" data-search="genres" data-value="æ‚¬ç–‘">æ‚¬ç–‘</a>
        <a href="javascript:void 0;" class="search" data-search="genres" data-value="å¤è£…">å¤è£…</a>
        <a href="javascript:void 0;" class="search" data-search="genres" data-value="æˆ˜äº‰">æˆ˜äº‰</a>
        <a href="javascript:void 0;" class="search" data-search="genres" data-value="æ­¦ä¾ ">æ­¦ä¾ </a>
        <a href="javascript:void 0;" class="search" data-search="genres" data-value="å†’é™©">å†’é™©</a>
        <a href="javascript:void 0;" class="search" data-search="genres" data-value="ç¾éš¾">ç¾éš¾</a>
        <a href="javascript:void 0;" class="search" data-search="genres" data-value="çˆ±æƒ…">çˆ±æƒ…</a>
        <a href="javascript:void 0;" class="search" data-search="genres" data-value="çœŸäººç§€">çœŸäººç§€</a>
        <a href="javascript:void 0;" class="search" data-search="genres" data-value="éŸ³ä¹">éŸ³ä¹</a>
        <a href="javascript:void 0;" class="search" data-search="genres" data-value="è„±å£ç§€">è„±å£ç§€</a>
        <a href="javascript:void 0;" class="search" data-search="genres" data-value="çŸ­ç‰‡">çŸ­ç‰‡</a>
        <a href="javascript:void 0;" class="search" data-search="genres" data-value="æƒŠæ‚š">æƒŠæ‚š</a>
        <a href="javascript:void 0;" class="search" data-search="genres" data-value="æ­Œèˆ">æ­Œèˆ</a>
        <a href="javascript:void 0;" class="search" data-search="genres" data-value="ä¼ è®°">ä¼ è®°</a>
        <a href="javascript:void 0;" class="search" data-search="genres" data-value="å„¿ç«¥">å„¿ç«¥</a>
        <a href="javascript:void 0;" class="search" data-search="genres" data-value="ææ€–">ææ€–</a>
        <a href="javascript:void 0;" class="search" data-search="genres" data-value="è¥¿éƒ¨">è¥¿éƒ¨</a>
      </div>
      <div class="years">
        <a href="javascript:void 0;" class="search" data-search="year" data-value="">å…¨éƒ¨</a>
        <a href="javascript:void 0;" class="search" data-search="year" data-value="2023">2023</a>
        <a href="javascript:void 0;" class="search" data-search="year" data-value="2022">2022</a>
        <a href="javascript:void 0;" class="search" data-search="year" data-value="2021">2021</a>
        <a href="javascript:void 0;" class="search" data-search="year" data-value="2020">2020</a>
        <a href="javascript:void 0;" class="search" data-search="year" data-value="2019">2019</a>
        <a href="javascript:void 0;" class="search" data-search="year" data-value="2018">2018</a>
        <a href="javascript:void 0;" class="search" data-search="year" data-value="2017">2017</a>
        <a href="javascript:void 0;" class="search" data-search="year" data-value="2016">2016</a>
        <a href="javascript:void 0;" class="search" data-search="year" data-value="2015">2015</a>
        <a href="javascript:void 0;" class="search" data-search="year" data-value="2014">2014</a>
        <a href="javascript:void 0;" class="search" data-search="year" data-value="2013">2013</a>
        <a href="javascript:void 0;" class="search" data-search="year" data-value="2012">2012</a>
        <a href="javascript:void 0;" class="search" data-search="year" data-value="2011">2011</a>
        <a href="javascript:void 0;" class="search" data-search="year" data-value="2010">2010</a>
        <a href="javascript:void 0;" class="search" data-search="year" data-value="2009">2009</a>
      </div>
      <div class="stars">
        <a href="javascript:void 0;" class="search" data-search="star" data-value="">å…¨éƒ¨</a>
        <a href="javascript:void 0;" class="search" data-search="star" data-value="5">äº”æ˜Ÿ</a>
        <a href="javascript:void 0;" class="search" data-search="star" data-value="4">å››æ˜Ÿ</a>
        <a href="javascript:void 0;" class="search" data-search="star" data-value="3">ä¸‰æ˜Ÿ</a>
        <a href="javascript:void 0;" class="search" data-search="star" data-value="2">äºŒæ˜Ÿ</a>
        <a href="javascript:void 0;" class="search" data-search="star" data-value="1">ä¸€æ˜Ÿ</a>
      </div>
    </div>
    <div class="content" id="content">

    </div>
  </div>
</body>
<script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
<script>
  // When the user scrolls down 20px from the top of the document, show the button
  window.onscroll = function () {
    scrollFunction()
  };

  function scrollFunction() {
    if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
      document.getElementById("myBtn").style.display = "block";
    } else {
      document.getElementById("myBtn").style.display = "none";
    }
  }

  // When the user clicks on the button, scroll to the top of the document
  function topFunction() {
    document.body.scrollTop = 0;
    document.documentElement.scrollTop = 0;
  }

  // é¡µé¢ä¸Šæ»‘åŠ è½½åŠ¨ç”»
  function animateSummaries() {

    const articles = document.querySelectorAll('.img-hide');
    // è¿™è¡Œä»£ç å°†articlesè½¬æ¢ä¸ºæ•°ç»„ï¼Œå¹¶ä½¿ç”¨sort()æ–¹æ³•å¯¹æ•°ç»„è¿›è¡Œéšæœºæ’åºï¼Œå®ç°å†…å®¹å—çš„é”™è½æ•ˆæœã€‚éšæœºæ’åºæ˜¯é€šè¿‡å°†ä¸€ä¸ªéšæœºæ•°ä¸0.5è¿›è¡Œæ¯”è¾ƒæ¥å®ç°çš„ã€‚
    const shuffledArticles = Array.from(articles).sort(() => Math.random() - 0.5);
    // è¿™æ˜¯ä¸€ä¸ªå†…éƒ¨å‡½æ•°ï¼Œç”¨äºè®¾ç½®å»¶è¿Ÿæ—¶é—´åå°†å†…å®¹å—æ˜¾ç¤ºå‡ºæ¥ã€‚articleå‚æ•°ä»£è¡¨è¦æ˜¾ç¤ºçš„å†…å®¹å—ï¼Œdelayå‚æ•°è¡¨ç¤ºåŠ¨ç”»çš„å»¶è¿Ÿæ—¶é—´ã€‚
    function animate(article, delay) {
      setTimeout(() => {
        article.classList.add('visible');
      }, delay);
    }
    // è¿™æ˜¯ä¸€ä¸ªé…ç½®å¯¹è±¡ï¼Œç”¨äºé…ç½®IntersectionObserverçš„é€‰é¡¹ã€‚rootMarginå±æ€§æŒ‡å®šå½“ç›®æ ‡å…ƒç´ è¿›å…¥è§†å£ä¸€å®šè·ç¦»å†…æ—¶è§¦å‘åŠ¨ç”»ã€‚
    const options = {
      rootMargin: '0px 0px -80px 0px',
    };
    // è¿™è¡Œä»£ç åˆ›å»ºäº†ä¸€ä¸ªIntersectionObserverå®ä¾‹ï¼Œç”¨äºè§‚å¯Ÿç›®æ ‡å…ƒç´ çš„ä½ç½®å˜åŒ–å¹¶è§¦å‘åŠ¨ç”»ã€‚å›è°ƒå‡½æ•°ä¸­çš„entrieså‚æ•°åŒ…å«äº†æ‰€æœ‰è§‚å¯Ÿçš„ç›®æ ‡å…ƒç´ çš„ä¿¡æ¯ã€‚
    const observer = new IntersectionObserver((entries) => {
      // è¿™è¡Œä»£ç ä½¿ç”¨forEach()æ–¹æ³•éå†entriesæ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªè§‚å¯Ÿç›®æ ‡å…ƒç´ ã€‚
      entries.forEach((entry, index) => {
        // è¿™è¡Œä»£ç æ£€æŸ¥å½“å‰å…ƒç´ æ˜¯å¦è¿›å…¥è§†å£ï¼ˆå¯è§éƒ¨åˆ†ï¼‰ï¼Œå³æ˜¯å¦å‡ºç°åœ¨ç”¨æˆ·æµè§ˆå™¨çš„å¯è§†åŒºåŸŸå†…ã€‚
        if (entry.isIntersecting) {
          // è¿™è¡Œä»£ç è°ƒç”¨animate()å‡½æ•°ï¼Œå¹¶ä¼ é€’å½“å‰ç›®æ ‡å…ƒç´ å’Œä¸€ä¸ªåŸºäºç´¢å¼•çš„å»¶è¿Ÿæ—¶é—´ã€‚é€šè¿‡å°†ç´¢å¼•ä¹˜ä»¥6ï¼Œæ¯ä¸ªå†…å®¹å—çš„åŠ¨ç”»æ•ˆæœä¼šä»¥ä¸åŒçš„å»¶è¿Ÿæ—¶é—´è§¦å‘ï¼Œå®ç°é”™è½æœ‰è‡´çš„æ•ˆæœã€‚
          animate(entry.target, index * 6); // æ·»åŠ å»¶è¿Ÿï¼Œå®ç°é”™è½æ•ˆæœ
          // è¿™è¡Œä»£ç åœ¨åŠ¨ç”»è§¦å‘ååœæ­¢è§‚å¯Ÿå½“å‰ç›®æ ‡å…ƒç´ ã€‚
          observer.unobserve(entry.target); // åŠ¨ç”»è§¦å‘ååœæ­¢è§‚å¯Ÿ
        }
      });
    }, options);
    // è¿™è¡Œä»£ç å¯¹éšæœºæ’åºåçš„æ¯ä¸ªå†…å®¹å—è¿›è¡Œè§‚å¯Ÿï¼Œä»¥ä¾¿åœ¨æ»‘åŠ¨æ—¶è§¦å‘ç›¸åº”çš„åŠ¨ç”»æ•ˆæœã€‚
    shuffledArticles.forEach((article) => {
      observer.observe(article);
    });
  }
  /**
   * ç»˜åˆ¶è¯„åˆ†åœ†ç¯
  */
  function drawMain(drawing_elem, percent, forecolor, bgcolor) {
    /*
        å€Ÿé‰´åœ°å€ï¼š[canvas ç»˜åˆ¶åŠ¨æ€åœ†ç¯è¿›åº¦æ¡_canvas ç¯å½¢è¿›åº¦æ¡ èƒŒæ™¯è‰²_å‰ç«¯å°ç™½çš„æ±Ÿæ¹–è·¯çš„åšå®¢-CSDNåšå®¢](https://blog.csdn.net/qq_21058391/article/details/76691047)
        https://github.com/klren0312/daliy_knowledge/issues/63
        @drawing_elem: ç»˜åˆ¶å¯¹è±¡
        @percentï¼šç»˜åˆ¶åœ†ç¯ç™¾åˆ†æ¯”, èŒƒå›´[0, 100]
        @forecolor: ç»˜åˆ¶åœ†ç¯çš„å‰æ™¯è‰²ï¼Œé¢œè‰²ä»£ç 
        @bgcolor: ç»˜åˆ¶åœ†ç¯çš„èƒŒæ™¯è‰²ï¼Œé¢œè‰²ä»£ç 
    */
    //  è·å–ç”»å¸ƒæ¥æ¸²æŸ“ä¸Šä¸‹æ–‡
    var context = drawing_elem.getContext("2d");
    var center_x = drawing_elem.width / 2;
    var center_y = drawing_elem.height / 2;
    // Math.PI è¡¨ç¤ºä¸€ä¸ªåœ†çš„å‘¨é•¿ä¸ç›´å¾„çš„æ¯”ä¾‹ï¼Œçº¦ä¸º 3.14159
    var rad = Math.PI * 2 / 100;
    // var speed = 0;
    var width = drawing_elem.width;
    var height = drawing_elem.height;

    if (window.devicePixelRatio) { //ç§»åŠ¨ç«¯é”¯é½¿è§£å†³æ–¹æ¡ˆ
      drawing_elem.style.width = width + "px";
      drawing_elem.style.height = height + "px";
      drawing_elem.height = height * window.devicePixelRatio;
      drawing_elem.width = width * window.devicePixelRatio;
      context.scale(window.devicePixelRatio, window.devicePixelRatio);
    }


    // ç»˜åˆ¶èƒŒæ™¯åœ†åœˆ
    function backgroundCircle() {
      // .save() æ˜¯ Canvas 2D API é€šè¿‡å°†å½“å‰çŠ¶æ€æ”¾å…¥æ ˆä¸­ï¼Œä¿å­˜ canvas å…¨éƒ¨çŠ¶æ€çš„æ–¹æ³•ã€‚
      context.save();
      // .beginPath() æ˜¯ Canvas 2D API é€šè¿‡æ¸…ç©ºå­è·¯å¾„åˆ—è¡¨å¼€å§‹ä¸€ä¸ªæ–°è·¯å¾„çš„æ–¹æ³•ã€‚å½“ä½ æƒ³åˆ›å»ºä¸€ä¸ªæ–°çš„è·¯å¾„æ—¶ï¼Œè°ƒç”¨æ­¤æ–¹æ³•ã€‚
      context.beginPath();
      // .lineWidth æ˜¯ Canvas 2D API è®¾ç½®çº¿æ®µåšåº¦çš„å±æ€§ï¼ˆå³çº¿æ®µçš„å®½åº¦ï¼‰
      context.lineWidth = 8; //è®¾ç½®çº¿å®½
      var radius = center_x - context.lineWidth;
      context.lineCap = "round";
      // .strokeStyle æ˜¯ Canvas 2D API æè¿°ç”»ç¬”ï¼ˆç»˜åˆ¶å›¾å½¢ï¼‰é¢œè‰²æˆ–è€…æ ·å¼çš„å±æ€§ã€‚é»˜è®¤å€¼æ˜¯ #000 (black)ã€‚
      context.strokeStyle = bgcolor;
      // .arc() æ˜¯ Canvas 2D API ç»˜åˆ¶åœ†å¼§è·¯å¾„çš„æ–¹æ³•ã€‚åœ†å¼§è·¯å¾„çš„åœ†å¿ƒåœ¨ (x, y) ä½ç½®ï¼ŒåŠå¾„ä¸º rï¼Œæ ¹æ®anticlockwise ï¼ˆé»˜è®¤ä¸ºé¡ºæ—¶é’ˆï¼‰æŒ‡å®šçš„æ–¹å‘ä» startAngle å¼€å§‹ç»˜åˆ¶ï¼Œåˆ° endAngle ç»“æŸã€‚
      context.arc(center_x, center_y, radius, 0, Math.PI * 2, false);
      // .stroke() æ˜¯ Canvas 2D API ä½¿ç”¨éé›¶ç¯ç»•è§„åˆ™ï¼Œæ ¹æ®å½“å‰çš„ç”»çº¿æ ·å¼ï¼Œç»˜åˆ¶å½“å‰æˆ–å·²ç»å­˜åœ¨çš„è·¯å¾„çš„æ–¹æ³•ã€‚
      context.stroke();
      // .closePath() æ˜¯ Canvas 2D API å°†ç¬”ç‚¹è¿”å›åˆ°å½“å‰å­è·¯å¾„èµ·å§‹ç‚¹çš„æ–¹æ³•ã€‚å®ƒå°è¯•ä»å½“å‰ç‚¹åˆ°èµ·å§‹ç‚¹ç»˜åˆ¶ä¸€æ¡ç›´çº¿ã€‚å¦‚æœå›¾å½¢å·²ç»æ˜¯å°é—­çš„æˆ–è€…åªæœ‰ä¸€ä¸ªç‚¹ï¼Œé‚£ä¹ˆæ­¤æ–¹æ³•ä¸ä¼šåšä»»ä½•æ“ä½œã€‚
      context.closePath();
      // .restore() æ˜¯ Canvas 2D API é€šè¿‡åœ¨ç»˜å›¾çŠ¶æ€æ ˆä¸­å¼¹å‡ºé¡¶ç«¯çš„çŠ¶æ€ï¼Œå°† canvas æ¢å¤åˆ°æœ€è¿‘çš„ä¿å­˜çŠ¶æ€çš„æ–¹æ³•ã€‚å¦‚æœæ²¡æœ‰ä¿å­˜çŠ¶æ€ï¼Œæ­¤æ–¹æ³•ä¸åšä»»ä½•æ”¹å˜ã€‚
      context.restore();
    }

    //ç»˜åˆ¶è¿åŠ¨åœ†ç¯
    function foregroundCircle(n) {
      context.save();
      context.strokeStyle = forecolor;
      context.lineWidth = 8;
      context.lineCap = "round";
      var radius = center_x - context.lineWidth;
      context.beginPath();
      context.arc(center_x, center_y, radius, -Math.PI / 2, -Math.PI / 2 + n * rad, false); //ç”¨äºç»˜åˆ¶åœ†å¼§context.arc(xåæ ‡ï¼Œyåæ ‡ï¼ŒåŠå¾„ï¼Œèµ·å§‹è§’åº¦ï¼Œç»ˆæ­¢è§’åº¦ï¼Œé¡ºæ—¶é’ˆ/é€†æ—¶é’ˆ)
      context.stroke();
      context.closePath();
      context.restore();
    }

    //ç»˜åˆ¶æ–‡å­—
    function text(n) {
      context.save(); //saveå’Œrestoreå¯ä»¥ä¿è¯æ ·å¼å±æ€§åªè¿ç”¨äºè¯¥æ®µcanvaså…ƒç´ 
      context.fillStyle = '#fff';
      var font_size = 12;
      // .font æ˜¯ Canvas 2D API æè¿°ç»˜åˆ¶æ–‡å­—æ—¶ï¼Œå½“å‰å­—ä½“æ ·å¼çš„å±æ€§ã€‚ä½¿ç”¨å’Œ CSS font è§„èŒƒç›¸åŒçš„å­—ç¬¦ä¸²å€¼ã€‚
      context.font = font_size + "px Helvetica";
      // è¯¥å¯¹è±¡åŒ…å«æœ‰å…³æµ‹é‡æ–‡æœ¬çš„ä¿¡æ¯ï¼ˆä¾‹å¦‚å…¶å®½åº¦ï¼‰
      var text_width = context.measureText(n.toFixed(0) + "%").width;
      // .fillText() æ˜¯ Canvas 2D API åœ¨ (x, y) ä½ç½®å¡«å……æ–‡æœ¬çš„æ–¹æ³•ã€‚å¦‚æœé€‰é¡¹çš„ç¬¬å››ä¸ªå‚æ•°æä¾›äº†æœ€å¤§å®½åº¦ï¼Œæ–‡æœ¬ä¼šè¿›è¡Œç¼©æ”¾ä»¥é€‚åº”æœ€å¤§å®½åº¦ã€‚
      context.fillText(n.toFixed(0) + "%", center_x - text_width / 2, center_y + font_size / 2);
      context.restore();
    }

    //æ‰§è¡ŒåŠ¨ç”»
    //  (function drawFrame(){
    // window.requestAnimationFrame(drawFrame);
    // .clearRect() æ˜¯ Canvas 2D API çš„æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•é€šè¿‡æŠŠåƒç´ è®¾ç½®ä¸ºé€æ˜ä»¥è¾¾åˆ°æ“¦é™¤ä¸€ä¸ªçŸ©å½¢åŒºåŸŸçš„ç›®çš„ã€‚
    context.clearRect(0, 0, drawing_elem.width, drawing_elem.height);
    backgroundCircle();
    text(percent);
    foregroundCircle(percent);
    // if(speed >= percent) return;
    // speed += 1;
    //  }());
  }

  var jsonFile = './data/douban/movie.json';
  getData(jsonFile);

  /**
   * é€šè¿‡ç‚¹å‡»äº‹ä»¶é«˜äº®ç­›é€‰æ¡ä»¶
  */
  document.addEventListener('click', function (e) {
    if (e.target.classList.contains('search')) {
      event.preventDefault(); // é˜²æ­¢é»˜è®¤ç‚¹å‡»è¡Œä¸º
      var search_type = e.target.dataset.search;
      document.querySelector(`.active[data-search="${search_type}"]`)?.classList.remove('active')
      var conditions = {};
      if (e.target.dataset.value) {
        e.target.classList.add('active')
      }
    }
    getData(jsonFile);
  })

  // ä½¿ç”¨$.ajax()æ–¹æ³•è·å–æœ¬åœ°JSONæ–‡ä»¶
  function getData(file) {
    $.ajax({
      url: file,
      dataType: 'json',
      success: function (data) {
        var filteredData;
        // ç”¨äºå­˜æ”¾ç­›é€‰æ¡ä»¶çš„å­—å…¸
        var conditions = {}
        // æŠ“å–å­˜æ”¾ç”µå½±å†…å®¹çš„å…ƒç´ 
        var content = $('#content');
        // åˆ¤æ–­æ˜¯å¦æœ‰ç­›é€‰æ¡ä»¶
        if ($('.search.active').length != 0) {
          for (let i = 0; i < $('.search.active').length; i++) {
            var active_type = $('.search.active')[i].dataset['search'];
            var active_value = $('.search.active')[i].dataset['value'];
            conditions[active_type] = active_value;
          }
          // console.log(conditions);
          // åˆ¤æ–­ç­›é€‰æ¡ä»¶æ˜¯å¦é€‰æ‹©
          const year = conditions['year'];
          const star = conditions['star'];
          const genres = conditions['genres'];

          // ä¸‹é¢ä»£ç çš„ç®€å†™æ–¹å¼
          filteredData = data.filter(
            item =>
              (typeof (year) === 'undefined' || item.subject.year == year) &&
              (typeof (star) === 'undefined' || Math.round(item.subject.rating.star_count) == star) &&
              (typeof (genres) === 'undefined' || item.subject.genres.indexOf(genres) > -1)
          );

          // if (typeof(conditions['year']) == "undefined" && typeof(conditions['genres']) == "undefined"){
          //   filteredData = data.filter(
          //     item => Math.round(item.subject.rating.star_count) == conditions['star']
          //   ) 
          // }else if (typeof(conditions['star']) == "undefined" && typeof(conditions['genres']) == "undefined"){
          //   filteredData = data.filter(
          //     item => item.subject.year == conditions['year']
          //   ) 
          // }else if (typeof(conditions['year']) == "undefined" && typeof(conditions['star']) == "undefined"){
          //   filteredData = data.filter(
          //     item => item.subject.genres.indexOf(conditions['genres']) > -1
          //   ) 
          // }else if(typeof(conditions['year']) == "undefined"){
          //   filteredData = data.filter(
          //     item => 
          //       Math.round(item.subject.rating.star_count) == conditions['star'] && 
          //       item.subject.genres.indexOf(conditions['genres']) > -1
          //   ) 
          // }else if (typeof(conditions['star']) == "undefined"){
          //   filteredData = data.filter(
          //     item => 
          //       item.subject.year == conditions['year'] && 
          //       item.subject.genres.indexOf(conditions['genres']) > -1
          //   ) 
          // }else if (typeof(conditions['genres']) == "undefined"){
          //   filteredData = data.filter(
          //     item => 
          //       item.subject.year == conditions['year'] && 
          //       Math.round(item.subject.rating.star_count) == conditions['star']
          //   ) 
          // }
          // else{
          //   filteredData = data.filter(
          //     item => 
          //       item.subject.year == conditions['year'] && 
          //       Math.round(item.subject.rating.star_count) == conditions['star'] && 
          //       item.subject.genres.indexOf(conditions['genres']) > -1
          //   ) 
          // }
        } else {
          filteredData = $.parseJSON(JSON.stringify(data));
        }
        // console.log(filteredData);
        // æ¸…ç©ºé¡µé¢
        content.html('');
        updatePage(content, filteredData);
        animateSummaries()
      },
      error: function (xhr, status, error) {
        // å¤„ç†é”™è¯¯æƒ…å†µ
        console.log('è·å–JSONæ•°æ®å¤±è´¥ï¼š' + error);
      }
    });
  }

  /**
   * å¡«å……é¡µé¢æ•°æ®
   * @param content é¡µé¢é¡¶éƒ¨div
   * @param Data æ•°æ®
   * 
  */
  function updatePage(content, Data) {
    // å®šä¹‰ç”µå½±æ ‡é¢˜å˜é‡
    let title = '';
    let picNormal = '';
    for (let i = 0; i < Data.length; i++) {
      // ç”µå½±ä¿¡æ¯
      let subject = Data[i]['subject'];
      // è¯„åˆ†
      let rating = Data[i]['rating'];
      // ç”µå½±é¢˜ç›®
      title = subject['title'];
      let subject_id = subject['id']; 
      // ç”µå½±é“¾æ¥
      // sharing_url = subject['sharing_url'];
      // ç”µå½±ç…§ç‰‡
      // picNormal = subject['pic']['normal'];
      // ç…§ç‰‡
      // cover_url = subject['cover_url'];
      // cover_url = './images/douban/' + cover_url.substring(cover_url.lastIndexOf('/') + 1);
      cover_url = 'https://dou.img.lithub.cc/movie/'+ subject_id +'.jpg';
      // å®˜æ–¹è¯„åˆ†é›†åˆ
      let ratings = subject['rating'];
      // é¢œè‰²é›†åˆ
      let color_scheme = subject['color_scheme'];
      let url = subject['url'];
      // å®˜æ–¹è¯„åˆ†é›†åˆ - å®˜æ–¹è¯„åˆ†
      let ratings_value = ratings['value'];
      var primary_color_dark;
      var secondary_color;
      if (color_scheme === null) {
        primary_color_dark = '85d824';
        // é¢œè‰²é›†åˆ - æ¬¡è¦é¢œè‰²
        secondary_color = 'eef7e4';
      } else {
        // é¢œè‰²é›†åˆ -ä¸»è¦é¢œè‰²
        // var primary_color_light = color_scheme['primary_color_light'];
        primary_color_dark = color_scheme['primary_color_dark'];
        // é¢œè‰²é›†åˆ - æ¬¡è¦é¢œè‰²
        secondary_color = color_scheme['secondary_color'];
      }
      // å®˜æ–¹è¯„åˆ† - å®˜æ–¹è¯„åˆ†æ˜Ÿæ˜Ÿæ•°
      let ratings_star_count = ratings['star_count'];


      // åˆ›å»ºæ–°çš„Divï¼Œæ¥å­˜æ”¾ç”µå½±å†…å®¹ï¼Œæ–¹ä¾¿å¸ƒå±€
      var newDiv = $("<div></div>");
      var canvasDiv = $("<div></div>");
      newDiv.addClass('list');
      newDiv.addClass('img-hide');
      canvasDiv.addClass('d-canvas');
      var newLink = $("<a></a>").attr({
        "href": url,
        "target": '_blank',
        "alt": title
      });
      var newLink2 = $("<a></a>").attr({
        "href": url,
        "target": '_blank',
        "alt": title
      });
      newLink2.addClass('info');
      // æ˜¾ç¤ºç”µå½±é¢˜ç›®
      var span_title = $('<h2>').text(title);
      // æ˜¾ç¤ºç”µå½±ç…§ç‰‡
      var newImg = $("<img />").attr({
        "src": cover_url,
        "alt": title
      });
      // æ˜¾ç¤ºä¸ªäººè¯„åˆ†
      var span_star = $('<div></div>');

      if (rating != null) {
        span_star.append('ä¸ªäººè¯„åˆ†ï¼š');
        let star_count = rating['star_count'];
        // console.log(star_count);
        for (let j = 0; j < star_count; j++) {
          span_star = span_star.append('â­');
        }
      } else {
        span_star.append('ä¸ªäººè¯„åˆ†ï¼šæœªè¯„åˆ†');
      }
      var ratings_star_span = $('<div></div>');
      ratings_star_span.append('è±†ç“£è¯„åˆ†ï¼š')
      for (let k = 0; k < ratings_star_count; k++) {
        ratings_star_span = ratings_star_span.append('ğŸŒŸ');
      }
      // åˆ›å»ºCanvaså…ƒç´ ï¼Œç”¨äºç»˜åˆ¶è¯„åˆ†åœ†ç¯
      var ratings_star_canvas = $('<canvas>').attr({
        width: 60,
        height: 60
      });
      ratings_star_canvas.attr('id', 'canvas' + i);
      drawMain(ratings_star_canvas[0], ratings_value * 10, '#' + primary_color_dark, '#' + secondary_color);
      ratings_star_span.append('&nbsp;&nbsp;&nbsp;' + ratings_value + '/10');
      newLink.append(newImg);
      canvasDiv.append(ratings_star_canvas);
      newDiv.append(canvasDiv);
      newDiv.append(newLink);
      newLink2.append(span_title);
      newLink2.append(span_star);
      newLink2.append(ratings_star_span);
      newDiv.append(newLink2);
      content.append(newDiv);
    }
  }




</script>

</html>